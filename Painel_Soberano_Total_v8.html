<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LAB-NEXUS | C137 Sovereign OS</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Inter:wght@300;400;600&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #C5A059; --bg: #050505; --surface: #121212; --glass: rgba(15,15,15,0.95); --green: #2ecc71; }
        body { background: var(--bg); color: #fff; font-family: 'Inter', sans-serif; margin: 0; padding-bottom: 90px; overflow-x: hidden; }
        
        .view { display: none; animation: fadeIn 0.3s ease-out; padding: 20px; }
        .view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- UI COMPONENTS --- */
        .mini-profile { padding: 20px; display: flex; align-items: center; gap: 15px; background: linear-gradient(to bottom, #151515, transparent); margin-bottom: 10px; }
        .avatar-sm { width: 45px; height: 45px; border-radius: 12px; border: 1px solid var(--gold); display: flex; align-items: center; justify-content: center; color: var(--gold); font-family: 'Cinzel'; font-weight: bold; }
        .services-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .service-card { background: var(--surface); padding: 25px 15px; border-radius: 20px; border: 1px solid #222; text-align: center; cursor: pointer; }
        .service-card i { color: var(--gold); margin-bottom: 10px; }
        .list-item { background: #0a0a0a; border: 1px solid #1a1a1a; padding: 18px; border-radius: 15px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; }
        .input-nexus { width: 100%; background: #000; border: 1px solid #333; padding: 12px; color: #fff; border-radius: 10px; font-family: 'JetBrains Mono'; font-size: 0.85rem; box-sizing: border-box; margin-bottom: 10px; }
        
        .btn-gold { background: var(--gold); color: #000; border: none; padding: 16px; border-radius: 12px; font-weight: bold; width: 100%; font-family: 'Cinzel'; cursor: pointer; margin-top: 10px; }
        .btn-outline { background: transparent; color: #fff; border: 1px solid #333; padding: 16px; border-radius: 12px; width: 100%; cursor: pointer; margin-top: 10px; text-align: center; display: block; text-decoration: none; }

        nav { position: fixed; bottom: 0; width: 100%; height: 75px; background: var(--glass); backdrop-filter: blur(15px); display: flex; justify-content: space-around; align-items: center; border-top: 1px solid #222; z-index: 9999; }
        .nav-btn { color: #444; text-align: center; font-size: 0.65rem; cursor: pointer; }
        .nav-btn.active { color: var(--gold); }
    </style>
</head>
<body>

    <div id="view-home" class="view active">
        <div class="mini-profile">
            <div class="avatar-sm" id="nav-initial">L</div>
            <div><b id="nav-alias" style="color:var(--gold)">$LABRIOLAG</b><br><small style="color:#555" id="nav-phrase">ARQUITETO SOBERANO</small></div>
        </div>
        <div class="services-grid">
            <div class="service-card" onclick="switchView('view-catalog')"><i data-lucide="file-plus-2"></i><b>LAVRAR</b><small>Contratos</small></div>
            <div class="service-card" onclick="switchView('view-bunker')"><i data-lucide="archive"></i><b>BUNKER</b><small>Registros</small></div>
            <div class="service-card" onclick="switchView('view-verify')"><i data-lucide="shield-check"></i><b>VERIFICAR</b><small>Validar Hash</small></div>
            <div class="service-card" onclick="switchView('view-profile')"><i data-lucide="settings"></i><b>PERFIL</b><small>Ajustes</small></div>
        </div>
    </div>

    <div id="view-catalog" class="view">
        <div id="catalog-main">
            <h2 style="font-family:'Cinzel'; color:var(--gold);">LAVRAR ATO</h2>
            <div id="category-list"></div>
            <button class="btn-outline" onclick="switchView('view-home')">VOLTAR</button>
        </div>
        <div id="form-dynamic" style="display:none;">
            <h2 id="dynamic-title" style="font-family:'Cinzel'; color:var(--gold);"></h2>
            <div id="dynamic-fields"></div>
            <button class="btn-gold" onclick="processSeal()">SELAR E SALVAR üìú</button>
            <button class="btn-outline" onclick="backToCatalog()">CANCELAR</button>
        </div>
    </div>

    <div id="view-verify" class="view">
        <h2 style="font-family:'Cinzel'; color:var(--gold);">VERIFICADOR</h2>
        <p style="font-size:0.7rem; color:#666; margin-bottom:20px;">Insira a Hash do documento para validar a integridade matem√°tica.</p>
        <input type="text" id="verify-input" class="input-nexus" placeholder="Cole a Hash aqui (ex: C137-...)">
        <button class="btn-gold" onclick="verifyHash()">VERIFICAR AGORA</button>
        <div id="verify-result" style="margin-top:20px;"></div>
        <button class="btn-outline" onclick="switchView('view-home')">VOLTAR</button>
    </div>

    <div id="view-bunker" class="view">
        <h2 style="font-family:'Cinzel'; color:var(--gold);">MEU BUNKER</h2>
        <div id="bunker-list"></div>
        <button class="btn-outline" onclick="switchView('view-home')">VOLTAR</button>
    </div>

    <div id="view-profile" class="view">
        <h2 style="font-family:'Cinzel'; color:var(--gold);">AJUSTES</h2>
        <input type="text" id="edit-alias" class="input-nexus" placeholder="$ALIAS">
        <input type="text" id="edit-phrase" class="input-nexus" placeholder="Bio">
        <button class="btn-gold" onclick="saveProfile()">SALVAR PERFIL</button>
        
        <div style="margin-top:40px; border-top:1px solid #222; padding-top:20px;">
            <h3 style="font-family:'Cinzel'; font-size:0.8rem; color:var(--gold);">BACKUP SOBERANO</h3>
            <button class="btn-outline" onclick="exportBunker()"><i data-lucide="download"></i> BAIXAR .NEXUS</button>
            <label class="btn-outline">
                <i data-lucide="upload"></i> IMPORTAR BACKUP
                <input type="file" id="import-f" style="display:none;" onchange="importBunker(this)">
            </label>
        </div>
    </div>

    <nav>
        <div class="nav-btn active" onclick="switchView('view-home')" id="btn-home"><i data-lucide="home"></i><br>In√≠cio</div>
        <div class="nav-btn" onclick="switchView('view-catalog')" id="btn-catalog"><i data-lucide="plus-square"></i><br>Lavrar</div>
        <div class="nav-btn" onclick="switchView('view-bunker')" id="btn-bunker"><i data-lucide="database"></i><br>Bunker</div>
        <div class="nav-btn" onclick="switchView('view-profile')" id="btn-profile"><i data-lucide="settings"></i><br>Perfil</div>
    </nav>

<script>
    const TEMPLATES = {
        locacao: { title: "Loca√ß√£o", icon: "home", fields: ["Locador", "Locat√°rio", "Valor"] },
        servico: { title: "Servi√ßo", icon: "briefcase", fields: ["Prestador", "Cliente", "Tarefa"] }
    };

    function switchView(id) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        const bId = 'btn-' + id.split('-')[1];
        if(document.getElementById(bId)) document.getElementById(bId).classList.add('active');
    }

    function renderCatalog() {
        const list = document.getElementById('category-list');
        list.innerHTML = Object.keys(TEMPLATES).map(k => `
            <div class="list-item" onclick="openForm('${k}')">
                <b>${TEMPLATES[k].title}</b><i data-lucide="${TEMPLATES[k].icon}"></i>
            </div>`).join('');
        lucide.createIcons();
    }

    function openForm(k) {
        document.getElementById('catalog-main').style.display = 'none';
        document.getElementById('form-dynamic').style.display = 'block';
        document.getElementById('dynamic-title').innerText = TEMPLATES[k].title;
        document.getElementById('dynamic-fields').innerHTML = TEMPLATES[k].fields.map(f => `
            <div class="input-box"><label>${f}</label><input type="text" class="input-nexus dyn-in" data-f="${f}"></div>
        `).join('');
    }

    function backToCatalog() {
        document.getElementById('catalog-main').style.display = 'block';
        document.getElementById('form-dynamic').style.display = 'none';
    }

    function processSeal() {
        const docTitle = document.getElementById('dynamic-title').innerText;
        const hash = "C137-" + Math.random().toString(36).substring(2, 12).toUpperCase();
        const bunker = JSON.parse(localStorage.getItem('c137_bunker') || '[]');
        bunker.unshift({ title: docTitle, hash: hash, date: new Date().toLocaleDateString() });
        localStorage.setItem('c137_bunker', JSON.stringify(bunker));
        alert("SELADO COM SUCESSO!\nHash: " + hash);
        renderBunker(); switchView('view-bunker'); backToCatalog();
    }

    function verifyHash() {
        const h = document.getElementById('verify-input').value.trim();
        const bunker = JSON.parse(localStorage.getItem('c137_bunker') || '[]');
        const found = bunker.find(i => i.hash === h);
        const res = document.getElementById('verify-result');
        if(found) {
            res.innerHTML = `<div style="color:var(--green); border:1px solid var(--green); padding:15px; border-radius:10px;">‚úÖ DOCUMENTO AUT√äNTICO<br><small>${found.title} selado em ${found.date}</small></div>`;
        } else {
            res.innerHTML = `<div style="color:red; border:1px solid red; padding:15px; border-radius:10px;">‚ùå HASH N√ÉO ENCONTRADA<br><small>Este documento n√£o existe ou foi alterado.</small></div>`;
        }
    }

    function renderBunker() {
        const d = JSON.parse(localStorage.getItem('c137_bunker') || '[]');
        document.getElementById('bunker-list').innerHTML = d.map(i => `<div class="list-item"><div><b>${i.title}</b><br><small>${i.hash}</small></div><i data-lucide="check-circle"></i></div>`).join('');
        lucide.createIcons();
    }

    function saveProfile() {
        const p = { alias: document.getElementById('edit-alias').value, phrase: document.getElementById('edit-phrase').value };
        localStorage.setItem('c137_profile', JSON.stringify(p));
        updateUI(); alert("Perfil Gravado!"); switchView('view-home');
    }

    function updateUI() {
        const s = JSON.parse(localStorage.getItem('c137_profile') || '{"alias":"$LABRIOLAG"}');
        document.getElementById('nav-alias').innerText = s.alias;
        document.getElementById('nav-initial').innerText = s.alias.replace('$','').charAt(0).toUpperCase();
        document.getElementById('edit-alias').value = s.alias;
        document.getElementById('edit-phrase').value = s.phrase || "";
    }

    function exportBunker() {
        const data = { profile: localStorage.getItem('c137_profile'), bunker: localStorage.getItem('c137_bunker') };
        const blob = new Blob([JSON.stringify(data)], {type: 'application/json'});
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'backup_bunker.nexus'; a.click();
    }

    function importBunker(el) {
        const reader = new FileReader();
        reader.onload = (e) => {
            const d = JSON.parse(e.target.result);
            localStorage.setItem('c137_profile', d.profile);
            localStorage.setItem('c137_bunker', d.bunker);
            location.reload();
        };
        reader.readAsText(el.files[0]);
    }

    window.onload = () => { lucide.createIcons(); updateUI(); renderCatalog(); renderBunker(); };
</script>
</body>
  </html>
